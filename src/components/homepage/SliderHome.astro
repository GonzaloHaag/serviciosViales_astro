---
import { Image } from 'astro:assets';
import bannerPortal from '../../images/banners-home-slide/Banner-portal-SV.webp';
import bannerProductos from '../../images/banners-home-slide/banner-productos-home.webp';
import bannerCrecemos from '../../images/banners-home-slide/SLIDER-crecemos.webp';
import bannerPortalMobile from '../../images/banners-home-slide/mobile/Banner-portal-SV.webp';
import bannerProductosMobile from '../../images/banners-home-slide/mobile/banner-productos-home.webp';
import bannerCrecemosMobile from '../../images/banners-home-slide/mobile/SLIDER-crecemos.webp';
import HomeSliderBgImage from './HomeSliderBgImage.astro';
---
<section class="slider">
 <!-- <Image src={bannerPortal} alt='banner portal' draggable="false" />
 <Image src={bannerProductos} alt='banner productos' draggable="false" />
 <Image src={bannerCrecemos} alt='banner crecemos' draggable="false" />
 <Image src={bannerProductos} alt='banner productos' draggable="false" /> -->
 <div class="w-full h-full bg-blend-color bg-black/40 ">
    <video autoplay muted loop class="h-full w-full object-cover absolute -z-10 aspect-video" poster="/assets/background-sections/poster-video.webp">
        <source src="/assets/video/SV-WEB-opti.mp4" type="video/mp4" />
    </video>
    <HomeSliderBgImage 
               titleBold="TU SOCIO" 
               titleNormal="CONFIABLE" 
               text="Ofrecemos excelencia y una amplia gama de productos para el óptimo funcionamiento de tu equipo." 
               buttonText="Conoce a SV"
               target_blank={parseInt('0')}
               buttonHref="/nosotros"
   />
</div>

 <div class="w-full h-full bg-blend-color bg-black/40 ">
     <Image src={ bannerPortal } alt='banner portal' draggable="false" class='absolute w-full h-full inset-0 -z-10' draggable="false" />
     <Image src={bannerPortalMobile} alt="banner portal" class="block lg:hidden absolute w-full h-full inset-0 -z-10 object-cover object-center" draggable="false" />
     <HomeSliderBgImage 
                titleBold="LO QUE NECESITAS," 
                titleNormal="FÁCIL Y RAPIDO" 
                text="Registrate ahora y accede a precios especiales dentro de nuestro portal de compras." 
                buttonText="Registrarse"
                target_blank={parseInt('1')}
                buttonHref="https://portal.sv.com.ar/crearusuario.aspx"
    />
 </div>
 <div class="w-full h-full bg-blend-color bg-black/40 ">
    <Image src={ bannerProductos } alt='banner productos' draggable="false" class='absolute w-full h-full inset-0 -z-10' draggable="false" />
    <Image src={bannerProductosMobile} alt="banner portal" class="block lg:hidden absolute w-full h-full inset-0 -z-10 object-cover object-center" draggable="false" />
    <HomeSliderBgImage 
    titleBold="AMPLIA VARIEDAD" 
    titleNormal="DE PRODUCTOS" 
    text="Descubrí la mejor calidad en filtros, repuestos, herramientas de corte, tren rodante y accesorios." 
    buttonText="Nuestros productos"
    target_blank={parseInt('0')}
    buttonHref="/productos"
    />
</div>
<div class="w-full h-full bg-blend-color bg-black/40 ">
    <Image src={ bannerCrecemos } alt='banner portal' draggable="false" class='absolute w-full h-full inset-0 -z-10' draggable="false" />
    <Image src={ bannerCrecemosMobile } alt="banner portal" class="block lg:hidden absolute w-full h-full inset-0 -z-10 object-cover object-center" draggable="false" />
    <HomeSliderBgImage 
             titleBold="CRECEMOS JUNTOS" 
             titleNormal="HACIA EL ÉXITO" 
             text="Son el motor fundamental de nuestro crecimiento, avanzamos gracias a su dedicación y compromiso." 
             buttonText="Trabajá con nosotros"
             target_blank={parseInt('0')}
             buttonHref="/nosotros/trabaja-con-nosotros"
             />
</div>

</section>
    <div class="dots">
        <div class="dots1"></div>
        <div class="dots2"></div>
        <div class="dots3"></div>
        <div class="dots4"></div>
    </div>

<style>
    .slider {
        width: 100%;
        height: calc(100vh - 9rem);
        display: flex;
        overflow: hidden;
        position: relative;
        cursor: grab;
        user-select: none;
    }
    .slider div{
        position: relative;
        width: 100%;
        flex: 0 0 100%;
        left: 0;
        transition: 1.2s;
    }
    .dots {
        display: flex;
        position: absolute;
        bottom: 2rem;
        width: 100%;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }
    .dots div {
        height: 20px;
        width: 20px;
        border-radius: 20px;
        transition: 0.7s;
        position: relative;
        background-color: white;
        opacity: 0.6;
    }
    .dots div:nth-child(1) {
        scale: 1.2;
        border: 1px solid white;
        opacity: 1;
    }
    @media (min-width:1024px) {
        .slider {
        width: 100%;
        height: calc(100vh - 8rem);
    }
    }
</style>
<script is:inline>

    document.addEventListener('astro:page-load',() => {
        let count = 1;
    let customChange = false;
    const sliding = (x) => {
        let left = `${-x*100}%`;
        let allSlide = document.querySelector('.slider').querySelectorAll('div');
        let allDots = document.querySelector('.dots').querySelectorAll('div');

        allSlide.forEach((element) => {
            element.style.left=left;
        })
        allDots.forEach((dots) => {
             dots.style.border = "unset";
             dots.style.scale = "1";
             dots.style.opacity = 0.6;
        });
        // active dot
        allDots[x].style.transition = '0.7s';
        allDots[x].style.scale='1.2';
        allDots[x].style.opacity='1';
    }

    setInterval(() => {
        if(customChange != true ) {
            if(count === 4) {
                sliding(0);
                count = 1;
            }
            else {
                sliding(count);
                count +=1;
            }
        }
    }, 8000);

    // Deslizamiento hacia la izquierda
    const leftSwipe = () => {
        customChange = true;
        setTimeout(() => {customChange=false},6000);
        if(count === 1) {
            sliding(3);
            count = 4;
        }
        else {
            count -= 1;
            sliding(count - 1);
        }
    }

    //Deslizamiento hacia la derecha 
    const rightSwipe = () => {
        customChange = true;
        setTimeout(() => {customChange=false},6000);
        if(count === 4) {
            sliding(0);
            count = 1;
        }
        else {
            sliding(count);
            count += 1;
        }
    }
    document.querySelector('.slider').onpointerdown=(e) => {
        let initX = e.clientX;
        document.querySelector('.slider').onpointerup=(up) => {
            let finalX = up.clientX;
            finalX - initX > 0 ? leftSwipe() : rightSwipe();
        }
    }
    })
   
</script>